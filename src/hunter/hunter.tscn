[gd_scene load_steps=26 format=3 uid="uid://ccvsw508kh4ot"]

[ext_resource type="Script" path="res://addons/godot_state_charts/state_chart.gd" id="1_0xkip"]
[ext_resource type="Script" path="res://addons/godot_state_charts/compound_state.gd" id="2_yqkoe"]
[ext_resource type="Script" path="res://addons/godot_state_charts/atomic_state.gd" id="3_ocdoo"]
[ext_resource type="Script" path="res://addons/godot_state_charts/transition.gd" id="4_x2w3t"]
[ext_resource type="PackedScene" uid="uid://cbv2ondm7xhnv" path="res://src/controller/synced/synced.tscn" id="5_uqurr"]
[ext_resource type="PackedScene" uid="uid://gvf2peg6yuns" path="res://src/controller/unpause_force/unpause_force.tscn" id="6_ujhjn"]
[ext_resource type="PackedScene" uid="uid://c18war56not2c" path="res://src/mediators/controller_state_chart_events/controller_state_chart_events.tscn" id="7_1ehsk"]
[ext_resource type="PackedScene" uid="uid://w68cagofxelw" path="res://src/controller/anti_button_spam/anti_button_spam.tscn" id="7_lf1vk"]
[ext_resource type="PackedScene" uid="uid://bee5jtcost270" path="res://src/controller/composite/composite.tscn" id="8_dmlm5"]
[ext_resource type="PackedScene" uid="uid://dfe7skxjkwons" path="res://src/controller/joypad/joypad.tscn" id="9_muve1"]
[ext_resource type="PackedScene" uid="uid://3hkpcs75ade2" path="res://src/controller/keyboard_and_mouse/keyboard_and_mouse.tscn" id="10_3bo02"]
[ext_resource type="PackedScene" uid="uid://b55ojigpr88dd" path="res://src/mediators/state_component/state_animation/state_animation.tscn" id="11_t3eqe"]
[ext_resource type="PackedScene" uid="uid://dfah2vi4kgnu7" path="res://src/mediators/state_component/flashlight_controller/flashlight_controller.tscn" id="12_j1s0g"]
[ext_resource type="PackedScene" uid="uid://ct3lglsww1564" path="res://src/mediators/state_component/move/move.tscn" id="12_r3uq0"]
[ext_resource type="PackedScene" uid="uid://djba3xyguo0kb" path="res://src/mediators/state_component/state_remote_property/state_remote_property.tscn" id="13_us43p"]
[ext_resource type="PackedScene" uid="uid://cy4qrm44icmyy" path="res://src/flashlight/flashlight.tscn" id="15_hljm8"]
[ext_resource type="PackedScene" uid="uid://co1edbkdtjj35" path="res://src/mediators/flashlight_state_chart_events/flashlight_state_chart_events.tscn" id="16_c1vhd"]
[ext_resource type="PackedScene" uid="uid://myko8836tn6o" path="res://src/rotation_to_vector/rotation_to_vector.tscn" id="16_se1mq"]
[ext_resource type="Script" path="res://src/remote_property.gd" id="18_mpyxa"]
[ext_resource type="PackedScene" uid="uid://cssdkhs4cty5c" path="res://src/costume/hunter_placeholder/hunter_placeholder.tscn" id="19_fj04q"]

[sub_resource type="SceneReplicationConfig" id="SceneReplicationConfig_hflh2"]
properties/0/path = NodePath(".:position")
properties/0/spawn = true
properties/0/replication_mode = 1

[sub_resource type="SceneReplicationConfig" id="SceneReplicationConfig_2bhal"]
properties/0/path = NodePath(".:limit_left")
properties/0/spawn = true
properties/0/replication_mode = 2
properties/1/path = NodePath(".:limit_top")
properties/1/spawn = true
properties/1/replication_mode = 2
properties/2/path = NodePath(".:limit_right")
properties/2/spawn = true
properties/2/replication_mode = 2
properties/3/path = NodePath(".:limit_bottom")
properties/3/spawn = true
properties/3/replication_mode = 2

[sub_resource type="CircleShape2D" id="CircleShape2D_vawb0"]
radius = 8.0

[sub_resource type="Gradient" id="Gradient_a05sb"]
colors = PackedColorArray(1, 1, 1, 1, 1, 1, 1, 0)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_xocc6"]
gradient = SubResource("Gradient_a05sb")
fill = 1
fill_from = Vector2(0.5, 0.5)
fill_to = Vector2(0.5, 0)

[node name="Hunter" type="CharacterBody2D" groups=["hunters"]]

[node name="MultiplayerSynchronizer" type="MultiplayerSynchronizer" parent="."]
replication_config = SubResource("SceneReplicationConfig_hflh2")

[node name="Camera2D" type="Camera2D" parent="."]
limit_left = 0
limit_top = 0
limit_right = 6400
limit_bottom = 6400

[node name="MultiplayerSynchronizer" type="MultiplayerSynchronizer" parent="Camera2D"]
replication_config = SubResource("SceneReplicationConfig_2bhal")

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
scale = Vector2(0.99, 0.99)
shape = SubResource("CircleShape2D_vawb0")

[node name="Synced" parent="." node_paths=PackedStringArray("controller") instance=ExtResource("5_uqurr")]
controller = NodePath("UnpauseForce/AntiButtonSpam")

[node name="UnpauseForce" parent="Synced" node_paths=PackedStringArray("controller") instance=ExtResource("6_ujhjn")]
controller = NodePath("AntiButtonSpam")

[node name="AntiButtonSpam" parent="Synced/UnpauseForce" node_paths=PackedStringArray("controller") instance=ExtResource("7_lf1vk")]
controller = NodePath("Composite")

[node name="Composite" parent="Synced/UnpauseForce/AntiButtonSpam" node_paths=PackedStringArray("controller_1", "controller_2") instance=ExtResource("8_dmlm5")]
controller_1 = NodePath("Joypad")
controller_2 = NodePath("KeyboardAndMouse")

[node name="Joypad" parent="Synced/UnpauseForce/AntiButtonSpam/Composite" instance=ExtResource("9_muve1")]

[node name="KeyboardAndMouse" parent="Synced/UnpauseForce/AntiButtonSpam/Composite" instance=ExtResource("10_3bo02")]

[node name="ControllerStateChartEvents" parent="Synced" node_paths=PackedStringArray("controller", "state_chart") instance=ExtResource("7_1ehsk")]
controller = NodePath("..")
state_chart = NodePath("../../StateChart")

[node name="StateChart" type="Node" parent="."]
script = ExtResource("1_0xkip")

[node name="CompoundState" type="Node" parent="StateChart"]
script = ExtResource("2_yqkoe")
initial_state = NodePath("Alive")

[node name="Dead" type="Node" parent="StateChart/CompoundState"]
script = ExtResource("3_ocdoo")

[node name="StateAnimation" parent="StateChart/CompoundState/Dead" node_paths=PackedStringArray("costume_behavior", "active_state") instance=ExtResource("11_t3eqe")]
animation_name = "dead"
costume_behavior = NodePath("../../../../YSort/HunterPlaceholder/Behavior")
active_state = NodePath("..")

[node name="Alive" type="Node" parent="StateChart/CompoundState"]
script = ExtResource("2_yqkoe")
initial_state = NodePath("Idle")

[node name="FlashlightController" parent="StateChart/CompoundState/Alive" node_paths=PackedStringArray("flashlight_behavior", "controller", "active_state") instance=ExtResource("12_j1s0g")]
flashlight_behavior = NodePath("../../../../YSort/Flashlight/Behavior")
controller = NodePath("../../../../Synced")
active_state = NodePath("..")

[node name="StateRemoteProperty" parent="StateChart/CompoundState/Alive" node_paths=PackedStringArray("remote_property", "active_state") instance=ExtResource("13_us43p")]
remote_property = NodePath("../../../../YSort/Flashlight/RemoteProperty")
process_callback = 0
active_state = NodePath("..")

[node name="Idle" type="Node" parent="StateChart/CompoundState/Alive"]
script = ExtResource("3_ocdoo")

[node name="MoveStarted" type="Node" parent="StateChart/CompoundState/Alive/Idle"]
script = ExtResource("4_x2w3t")
to = NodePath("../../Move")
event = &"move_started"

[node name="StateAnimation" parent="StateChart/CompoundState/Alive/Idle" node_paths=PackedStringArray("costume_behavior", "active_state") instance=ExtResource("11_t3eqe")]
animation_name = "idle"
costume_behavior = NodePath("../../../../../YSort/HunterPlaceholder/Behavior")
active_state = NodePath("..")

[node name="Move" type="Node" parent="StateChart/CompoundState/Alive"]
script = ExtResource("2_yqkoe")
initial_state = NodePath("MoveNormal")

[node name="MoveStopped" type="Node" parent="StateChart/CompoundState/Alive/Move"]
script = ExtResource("4_x2w3t")
to = NodePath("../../Idle")
event = &"move_stopped"

[node name="StateAnimation" parent="StateChart/CompoundState/Alive/Move" node_paths=PackedStringArray("costume_behavior", "active_state") instance=ExtResource("11_t3eqe")]
animation_name = "move"
costume_behavior = NodePath("../../../../../YSort/HunterPlaceholder/Behavior")
active_state = NodePath("..")

[node name="MoveNormal" type="Node" parent="StateChart/CompoundState/Alive/Move"]
script = ExtResource("3_ocdoo")

[node name="FlashlightPowered" type="Node" parent="StateChart/CompoundState/Alive/Move/MoveNormal"]
script = ExtResource("4_x2w3t")
to = NodePath("../../MoveSlow")
event = &"flashlight_powered"

[node name="Move" parent="StateChart/CompoundState/Alive/Move/MoveNormal" node_paths=PackedStringArray("controller", "character", "active_state") instance=ExtResource("12_r3uq0")]
controller = NodePath("../../../../../../Synced")
character = NodePath("../../../../../..")
speed = 74.0
active_state = NodePath("..")

[node name="MoveSlow" type="Node" parent="StateChart/CompoundState/Alive/Move"]
script = ExtResource("3_ocdoo")

[node name="FlashlightPowered" type="Node" parent="StateChart/CompoundState/Alive/Move/MoveSlow"]
script = ExtResource("4_x2w3t")
to = NodePath("../../MoveNormal")
event = &"flashlight_unpowered"

[node name="Move" parent="StateChart/CompoundState/Alive/Move/MoveSlow" node_paths=PackedStringArray("controller", "character", "active_state") instance=ExtResource("12_r3uq0")]
controller = NodePath("../../../../../../Synced")
character = NodePath("../../../../../..")
speed = 29.6
active_state = NodePath("..")

[node name="YSort" type="Node2D" parent="."]
y_sort_enabled = true

[node name="Flashlight" parent="YSort" instance=ExtResource("15_hljm8")]

[node name="FlashlightStateChartEvents" parent="YSort/Flashlight" node_paths=PackedStringArray("flashlight_data", "state_chart") instance=ExtResource("16_c1vhd")]
flashlight_data = NodePath("../Data")
state_chart = NodePath("../../../StateChart")

[node name="RemoteProperty" type="Node" parent="YSort/Flashlight" node_paths=PackedStringArray("source_node", "destination_node")]
script = ExtResource("18_mpyxa")
source_node = NodePath("../RotationToVector")
source_property = "vector"
destination_node = NodePath("../../HunterPlaceholder/Behavior")
destination_property = "direction_vector"
process_callback = 2

[node name="RotationToVector" parent="YSort/Flashlight" node_paths=PackedStringArray("source_node") instance=ExtResource("16_se1mq")]
source_node = NodePath("../Data")
source_variable = "flashlight_rotation"

[node name="HunterPlaceholder" parent="YSort" instance=ExtResource("19_fj04q")]

[node name="PointLight2D" type="PointLight2D" parent="."]
energy = 0.5
range_item_cull_mask = 33
texture = SubResource("GradientTexture2D_xocc6")
height = 16.0

[editable path="YSort/Flashlight"]
[editable path="YSort/HunterPlaceholder"]
